pipeline {
    agent {label 'ansible'}
    
    stages {
        stage('Deploy Web application') {
            steps {
                echo "========== DEPLOY WEB APP START =========="
                sh "ip -4 a"
                sh "ansible --version"
                sh "ansible all --list-hosts -i inventory.yaml"
                ansiblePlaybook(
                    vaultCredentialsId: 'AnsibleVault', 
                    inventory: 'inventory.yaml', 
                    playbook: 'start_web.yaml'
                )
            }
        }
    }
}
